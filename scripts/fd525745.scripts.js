!function(){"use strict";var a,b;a="/api_mock",b=angular.module("NextBBSWebApp",["ui.router","ngCookies","pascalprecht.translate"]),b.config(["$stateProvider","$routeProvider","$urlRouterProvider","$translateProvider",function(a,b,c,d){return c.when("/p?id","/p/:id").when("/b?id","/b/:id").when("/b/","/board").when("/u?id","/user/:id").otherwise("/"),b.when("/user/:id",{redirectTo:"/posts/:id"}),a.state("root",{url:"/","abstract":!0,templateUrl:"views/layout.html"}).state("root.nav",{url:"",views:{nav:{templateUrl:"views/nav.html",controller:"NavCtrl"},"":{templateUrl:"views/home.html"}}}).state("root.nav.board_index",{url:"board",views:{"@root":{templateUrl:"views/board.html"}}}).state("root.nav.board",{url:"b/:boardId","abstract":!0,views:{"@root":{templateUrl:"views/layout_board.html"}}}).state("root.nav.board.posts",{url:"",views:{posts:{templateUrl:"views/posts.html",resolve:{posts:["posts",function(a){return a.all()}]},controller:"PostCtrl"},"":{templateUrl:"views/board_home.html"}}}).state("root.nav.board.posts.content",{url:"/p/:postId",views:{"@root.nav.board":{templateUrl:"views/content.html",controller:"ContentCtrl"}}}),d.useStaticFilesLoader({prefix:"locale/locale-",suffix:".json"}),d.preferredLanguage("zh-TW"),d.useLocalStorage()}]).run(["$rootScope","$state","$stateParams","utils",function(a,b,c){return a.$state=b,a.$stateParams=c}]),b.service("notifyMassage",function(){return this.alert=function(a,b){var c;switch(c={text:b,addclass:"custom",opacity:.8,nonblock:!0,nonblock_opacity:.2},a){case"error":c.title="Sorry",c.icon="icon-warning-sign icon-2x icon-light",c.type="error";break;case"info":c.title="Tips",c.icon="icon-info-sign icon-2x icon-light",c.type="info";break;case"success":c.title="Success",c.icon="icon-thumbs-up icon-2x icon-light",c.type="success";break;case"debug":c.title="Debug Message",c.icon="icon-thumbs-up icon-2x icon-light",c.type="success"}return $.pnotify.defaults.history=!1,$.pnotify(c)}}),b.factory("posts",["$http",function(b,c){var d,e,f;return e=a+"/list.json",f=b.get(e).then(function(a){return a.data.data.items}),d={},d.all=function(){return f},d.get=function(a){return f.then(function(){return c.findById(f,a)})},d.next=function(a){return f.then(function(){return c.findNextById(f,a)})},d}]),b.factory("utils",function(){var a,b,c,d;return{findById:a=function(a,b){var c;for(c=0;c<a.length;){if(a[c].id===b)return a[c];c++}return null},findNextById:b=function(a,b){var c;for(c=0;c<a.length;){if(a[c].id===b)return a[c-1];c++}return null},findPrevById:c=function(a,b){var c;for(c=0;c<a.length;){if(a[c].id===b)return a[c+1];c++}return null},newRandomKey:d=function(a,b,c){var d;for(d=void 0;d=a[Math.floor(a.length*Math.random())][b],d===c;);return d}}})}.call(this),function(){"use strict";var a;a=angular.module("NextBBSWebApp"),a.controller("NavCtrl",["$scope","$state","notifyMassage",function(){return Mousetrap.bind("y",function(){return console.log("y")}),Mousetrap.bind("h",function(){return console.log("h")})}])}.call(this),function(){"use strict";var a;a=angular.module("NextBBSWebApp"),a.controller("PostCtrl",["$scope","$state","$document","notifyMassage","posts","utils",function(a,b,c,d,e,f){return a.posts=e,a.showPostById=function(a,c){return void 0===c&&(c=b.params.boardId),location.href="/#/b/"+c+"/p/"+a},Mousetrap.bind("j",function(){var c,d,e,g,h,i,j,k;return h=f.findNextById(a.posts,b.params.postId),void 0!==h&&a.showPostById(h.id),e=$("#posts")[0].scrollTop,k=$(window).height(),d=$(".post-item-selected")[0].offsetTop,g=parseInt(k)/2+parseInt(e),j=parseInt(d)-parseInt(g)+parseInt(e),c=parseInt(k)/2+parseInt(g),parseInt(j)<0&&(j=0),parseInt(j)>parseInt(c)&&(j=parseInt(c)),i=parseInt(d)>parseInt(g)||parseInt(k)/2+parseInt(d)<parseInt(g),i?angular.element("#posts").scrollTop(parseInt(j)):void 0}),Mousetrap.bind("k",function(){var c,d,e,g,h,i,j,k;return g=f.findPrevById(a.posts,b.params.postId),void 0!==g&&a.showPostById(g.id),e=$("#posts")[0].scrollTop,k=$(window).height(),d=$(".post-item-selected")[0].offsetTop,j=parseInt(k)/2+parseInt(e),i=parseInt(e)-parseInt(j)+parseInt(d),c=parseInt(k)/2+parseInt(j),parseInt(i)<0&&(i=0),parseInt(i)>parseInt(c)&&(i=parseInt(c)),h=parseInt(d)<parseInt(j)||parseInt(d)-parseInt(k)/2>parseInt(j),h?angular.element("#posts").scrollTop(parseInt(i)):void 0}),Mousetrap.bind("tab",function(){return Mousetrap.trigger("j")}),Mousetrap.bind("q",function(){return Mousetrap.trigger("k")})}])}.call(this),function(){"use strict";var a;a=angular.module("NextBBSWebApp"),a.controller("ContentCtrl",["$scope","$state","notifyMassage",function(){return Mousetrap.bind("o",function(){return window.scrollTo(0,document.documentElement.scrollTop-$(window).height()+20)}),Mousetrap.bind("l",function(){return window.scrollTo(0,document.documentElement.scrollTop+$(window).height()-20)}),Mousetrap.bind("right",function(){return Mousetrap.trigger("l")}),Mousetrap.bind("left",function(){return Mousetrap.trigger("o")})}])}.call(this);