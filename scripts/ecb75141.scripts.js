!function(){"use strict";var a,b;a="/api_mock",b=angular.module("NextBBSWebApp",["ui.router","ngCookies","pascalprecht.translate","mousetrap","infinite-scroll"]),b.config(["$stateProvider","$routeProvider","$urlRouterProvider","$translateProvider",function(a,b,c,d){return c.when("/p?id","/p/:id").when("/b?id","/b/:id").when("/b/","/board").when("/u?id","/user/:id").otherwise("/"),b.when("/user/:id",{redirectTo:"/posts/:id"}),a.state("root",{url:"/","abstract":!0,templateUrl:"views/layout.html"}).state("root.nav",{url:"",views:{nav:{templateUrl:"views/nav.html",controller:"NavCtrl"},"":{templateUrl:"views/home.html"}}}).state("root.nav.board_index",{url:"board",views:{"@root":{templateUrl:"views/board.html"}}}).state("root.nav.board",{url:"b/:boardId","abstract":!0,views:{"@root":{templateUrl:"views/layout_board.html"}}}).state("root.nav.board.posts",{url:"",views:{posts:{templateUrl:"views/posts.html",resolve:{posts:["posts",function(a){return a.all()}]},controller:"PostCtrl"},"":{templateUrl:"views/board_home.html"}}}).state("root.nav.board.posts.content",{url:"/p/:postId",views:{"@root.nav.board":{templateUrl:"views/content.html",controller:"ContentCtrl"}}}),d.useStaticFilesLoader({prefix:"locale/locale-",suffix:".json"}),d.preferredLanguage("zh-TW"),d.useLocalStorage()}]).run(["$rootScope","$state","$stateParams","utils",function(a,b,c){return a.$state=b,a.$stateParams=c}]),b.service("notifyMassage",function(){return this.alert=function(a,b){var c;switch(c={text:b,addclass:"custom",opacity:.8,nonblock:!0,nonblock_opacity:.2},a){case"error":c.title="Sorry",c.icon="icon-warning-sign icon-2x icon-light",c.type="error";break;case"info":c.title="Tips",c.icon="icon-info-sign icon-2x icon-light",c.type="info";break;case"success":c.title="Success",c.icon="icon-thumbs-up icon-2x icon-light",c.type="success";break;case"debug":c.title="Debug Message",c.icon="icon-thumbs-up icon-2x icon-light",c.type="success"}return $.pnotify.defaults.history=!1,$.pnotify(c)}}),b.factory("posts",["$http",function(b,c){var d,e,f;return e=a+"/list.json",f=b.get(e).then(function(a){return a.data.data.items}),d={},d.all=function(){return f},d.get=function(a){return f.then(function(){return c.findById(f,a)})},d}]),b.factory("utils",function(){var a,b,c,d;return{findById:a=function(a,b){var c;for(c=0;c<a.length;){if(a[c].id===b)return a[c];c++}return null},findNextById:b=function(a,b){var c;for(c=0;c<a.length;){if(a[c].id===b)return a[c-1];c++}return null},findPrevById:c=function(a,b){var c;for(c=0;c<a.length;){if(a[c].id===b)return a[c+1];c++}return null},newRandomKey:d=function(a,b,c){var d;for(d=void 0;d=a[Math.floor(a.length*Math.random())][b],d===c;);return d}}})}.call(this),function(){"use strict";var a;a=angular.module("NextBBSWebApp"),a.controller("NavCtrl",["$scope","$state","notifyMassage",function(){return Mousetrap.bind("y",function(){return console.log("y")}),Mousetrap.bind("h",function(){return console.log("h")})}])}.call(this),function(){"use strict";var a;a=angular.module("NextBBSWebApp"),a.controller("PostCtrl",["$scope","$state","$document","notifyMassage","posts","utils",function(a,b,c,d,e,f){var g;return a.posts=e,a.showPostById=function(a,c){return void 0===c&&(c=b.params.boardId),location.href="/#/b/"+c+"/p/"+a},g=function(c){var d,e,g,h,i,j,k,l,m,n,o,p;return g=angular.element("#posts")[0].scrollTop,p=angular.element(window).height(),e=angular.element(".post-item-selected")[0].offsetTop,"down"===c&&(j=f.findNextById(a.posts,b.params.postId),void 0!==j&&a.showPostById(j.id),i=parseInt(p)/2-160,h=i+parseInt(g),m=parseInt(e)-parseInt(h)+parseInt(g),d=i+parseInt(h)),"up"===c&&(k=f.findPrevById(a.posts,b.params.postId),void 0!==k&&a.showPostById(k.id),o=parseInt(p)/2+14,n=o+parseInt(g),m=parseInt(g)-parseInt(n)+parseInt(e),d=o+parseInt(n)),parseInt(m)<0&&(m=0),parseInt(m)>parseInt(d)&&(m=parseInt(d)),"down"===c&&(l=parseInt(e)>parseInt(h)||i+parseInt(e)<parseInt(h)),"up"===c&&(l=parseInt(e)<parseInt(n)||parseInt(e)-o>parseInt(n)),l?angular.element("#posts").animate({scrollTop:parseInt(m)},0):void 0},Mousetrap.bind("j",function(){return g("down")}),Mousetrap.bind("k",function(){return g("up")}),Mousetrap.bind("tab",function(){return Mousetrap.trigger("j")}),Mousetrap.bind("q",function(){return Mousetrap.trigger("k")})}])}.call(this),function(){"use strict";var a;a=angular.module("NextBBSWebApp"),a.controller("ContentCtrl",["$scope","$state","notifyMassage",function(){return Mousetrap.bind("o",function(){var a,b,c;return a=angular.element(document.documentElement)[0].scrollTop,c=angular.element(window).height(),b=parseInt(a)-parseInt(c)+20,angular.element(document.documentElement).animate({scrollTop:b},0)}),Mousetrap.bind("l",function(){var a,b,c;return a=angular.element(document.documentElement)[0].scrollTop,c=angular.element(window).height(),b=parseInt(a)+parseInt(c)-20,angular.element(document.documentElement).animate({scrollTop:b},0)}),Mousetrap.bind("right",function(){return Mousetrap.trigger("l")}),Mousetrap.bind("left",function(){return Mousetrap.trigger("o")})}])}.call(this);